00100   : REM ' APPOINT/BAS: MAKES A REMINDX/DAT FILE.
00110   CLS : CLEAR 1000
00120   OPEN "R",1,"REMIND1/DAT",41
00130   OPEN "R",2,"REMIND2/DAT",64
00140   FIELD 2,64 AS V$
00150   FIELD 1,1ASMN$,8ASMI$,3ASHR$,1ASDA$,7ASD1$,7ASD2$,7ASD3$,7ASD4$
00160   DIM DN$(7): FOR T = 1 TO 7
00170   READ DN$(T): NEXT T
00180   DATA SUNDAY,MONDAY,TUESDAY,WEDNESDAY
00190   DATA THURSDAY,FRIDAY,SATURDAY
00200   CLS
00210   PRINT "NUMBER OF MESSAGES:"; LOF(2)
00220   PRINT "NUMBER OF REMINDERS:"; LOF(1)
00230   PRINT "HIT <M> TO INPUT MESSAGE"
00240   PRINT "HIT <P> THEN <M> TO PRINT MESSAGES"
00250   PRINT "HIT <P> THEN <R> TO PRINT REMINDERS"
00260   PRINT "HIT <R> TO INPUT REMINDER"
00270   PRINT "HIT <E> TO EXIT PROGRAM"
00280   A$ = INKEY$ : IF A$ = "" THEN 280
00290   IF A$ = "M" THEN GOTO 3000
00300   IF A$ = "P" THEN GOTO 4000
00310   IF A$ = "R" THEN GOTO 5000
00320   IF A$ <> "E" THEN GOTO 280
00330   CLOSE
00340   END
00420   RE = 0
00430   RE = RE + 1: PRINT "RECORD NUMBER";RE
00440   INPUT "MESSAGE # (OR 0)";M
00450   IF M = 0 THEN CLOSE 1: RUN "REMINDER/BAS"
00460   A$ = CHR$(M): LSET MN$ = A$
00470   A$ = STRING$(8,0)
00480   INPUT "MINUTES,RANGE,STEP (OR 64)";M1,M2,M3
00490   IF M1 = 64 THEN GOTO 540
00500   FOR T = M1 TO M2 STEP M3
00510   GOSUB 1000:: REM ' POKE IN BIT T OF A$
00520   NEXT T
00530   GOTO 480
00540   LSET MI$ = A$
00550   A$ = STRING$(3,0)
00560   INPUT "HOURS,RANGE,STEP (OR 64)";H1,H2,H3
00570   IF H1 = 64 THEN GOTO 620
00580   FOR T = H1 TO H2 STEP H3
00590   GOSUB 1000:: REM ' POKE IN HOUR BIT
00600   NEXT T
00610   GOTO 560
00620   LSET HR$ = A$
00630   A$ = CHR$(0)
00640   INPUT "DAYS,RANGE,STEP (OR 64)";H1,H2,H3
00650   IF H1 = 64 THEN GOTO 700
00660   FOR T = H1 TO H2 STEP H3
00670   GOSUB 1000:: REM ' POKE IN DAY BIT
00680   NEXT T
00690   GOTO 640
00700   LSET DA$ = A$
00710   FL = 0
00720   GOSUB 2000:: REM ' GET DATE RANGE
00730   LSET D1$ = E$
00740   GOSUB 2000
00750   LSET D2$ = E$
00760   GOSUB 2000
00770   LSET D3$ = E$
00780   GOSUB 2000
00790   LSET D4$ = E$
00800   PUT 1,RE
00810   GOTO 430
01000   : REM ' POKE IN BIT T OF A$
01010   F1 = INT(T / 8)
01020   F2 = T - F1 * 8
01030   F3 = 2 ^ F2
01040   Y$ = MID$(A$,F1 + 1,1)
01050   Y = ASC(Y$) OR F3
01060   Y$ = CHR$(Y)
01070   MID$(A$,F1 + 1,1) = Y$
01080   RETURN
02000   IF FL = 1 THEN A$ = "01/01/00": GOTO 2050
02010   IF FL = 2 THEN A$ = "NULL": GOTO 2040
02020   INPUT "DATE1 (OR 64)";A$
02030   IF A$ = "64" THEN A$ = "01/01/00":FL = 1
02040   IF A$ = "NULL" THEN A$ = "12/31/99":FL = 2
02050   YE = VAL(MID$(A$,7,2))
02060   CMD "J",A$,G$
02070   D = VAL(G$)
02080   Y$ = CHR$(YE):D$ = MKI$(D)
02090   IF FL = 1 THEN A$ = "64": GOTO 2120
02100   IF FL = 2 THEN A$ = "12/31/99": GOTO 2120
02110   INPUT "DATE2 (OR 64)";A$
02120   IF A$ = "64" THEN A$ = "01/01/00"
02130   YE = VAL(MID$(A$,7,2))
02140   CMD "J",A$,G$
02150   D = VAL(G$)
02160   Y2$ = CHR$(YE):D2$ = MKI$(D)
02170   X = 1:: REM ' INCREMENT
02180   X$ = CHR$(X)
02190   E$ = Y$ + D$ + Y2$ + D2$ + X$
02200   RETURN
03000   : REM ' INPUT MESSAGES
03010   M = LOF(2) + 1:M$ = ""
03020   INPUT "MESSAGE NUMBER (OR <ENTER> OR 'END')";M$
03030   IF M$ = "END" THEN GOTO 200
03040   IF VAL(M$) <> 0 THEN M = VAL(M$)
03050   IF M>LOF(2) + 1 THEN GOTO 3010
03060   PRINT "INPUTTING MESSAGE NUMBER";M
03070   LINE INPUT A$
03080   IF LEN(A$)> 63 THEN PRINT "STRING TOO LONG": GOTO 3070
03090   LSET V$ = A$
03100   PUT 2,M
03110   GOTO 3010
04000   : REM ' PRINT MESSAGES OR REMINDERS
04010   A$ = INKEY$ : IF A$ = "" THEN 4010
04020   IF A$ = "M" THEN GOTO 4200
04030   IF A$ = "R" THEN GOTO 4500
04040   GOTO 200
04200   : REM ' PRINT MESSAGES ONLY
04210   M$ = ""
04220   PRINT "NUMBER OF MESSAGES:"; LOF(2)
04230   INPUT "NUMBER,RANGE,'ALL' OR 'END'";M$
04240   IF M$ = "END" THEN GOTO 200
04250   IF M$ = "ALL" THEN M1 = 1:M2 = LOF(2): GOTO 4300
04260   M1 = VAL(M$): IF M1 = 0 THEN GOTO 4210
04270   I1 = INSTR(M$,"-")
04280   IF I1 = 0 THEN M2 = M1: GOTO 4300
04290   M2 = VAL(RIGHT$(M$, LEN(M$) - I1))
04300   IF M2>LOF(2) THEN GOTO 4210
04310   FOR T = M1 TO M2
04320   GET 2,T
04330   PRINT LEFT$(V$,63)
04340   NEXT T
04350   GOTO 4210
04500   : REM ' PRINT REMINDERS ONLY
04510   M$ = "":F1 = 0
04520   PRINT "NUMBER OF REMINDERS:"; LOF(1)
04530   INPUT "REMINDER NUMBER OR 'END'";M$
04540   IF M$ = "END" THEN GOTO 200
04550   M = VAL(M$)
04560   IF M < 1 OR M>LOF(1) GOTO 4510
04570   GET 1,M
04580   CLS
04590   PRINT "REMINDER NUMBER:";M
04600   PRINT "ASSOCIATED MESSAGE:"; ASC(MN$)
04602   GET 2, ASC(MN$): PRINT LEFT$(V$,63)
04610   PRINT "MINUTES ALLOWED: ";
04620   A$ = MI$
04630   FOR T = 00 TO 59
04640   B = T: GOSUB 6000:: REM ' TEST BIT B OF A$
04650   IF FL = 0 THEN GOTO 4690
04660   T$ = STR$(T):T1 = LEN(T$)
04670   IF F1 = 1 THEN PRINT ","; : ELSE F1 = 1
04680   PRINT RIGHT$(T$,T1 - 1);
04690   NEXT T
04700   PRINT
04710   : REM ' CHECK HOURS ALLOWED
04720   A$ = HR$
04730   F1 = 0
04740   PRINT "HOURS ALLOWED: ";
04750   FOR T = 0 TO 23
04760   B = T: GOSUB 6000
04770   IF FL = 0 THEN GOTO 4810
04780   IF F1 = 1 THEN PRINT ","; : ELSE F1 = 1
04790   T$ = STR$(T):T1 = LEN(T$)
04800   PRINT RIGHT$(T$,T1 - 1);
04810   NEXT T
04820   PRINT
04830   F1 = 0:A$ = DA$
04840   PRINT "DAYS ALLOWED: ";
04850   IF A$ = CHR$(255) THEN PRINT "ALL DAYS": GOTO 4930
04860   FOR T = 1 TO 7
04870   B = T: GOSUB 6000
04880   IF FL = 0 THEN GOTO 4910
04890   IF F1 = 1 THEN PRINT ","; : ELSE F1 = 1
04900   PRINT DN$(T);
04910   NEXT T
04920   PRINT
04930   PRINT "ALLOWABLE DATES:"
04940   IF ASC(LEFT$(D1$,1)) = 0 THEN PRINT "ALL DATES ALLOWED": GOTO 4510
04950   A$ = D1$: GOSUB 7000:: REM ' PRINT DATES
04960   A$ = D2$: GOSUB 7000
04970   A$ = D3$: GOSUB 7000
04980   A$ = D4$: GOSUB 7000
04990   GOTO 4510
05000   : REM ' INPUT REMINDERS
05010   M$ = ""
05020   PRINT "NUMBER OF REMINDERS:"; LOF(1)
05030   INPUT "REMINDER NUMBER OR 'END'";M$
05040   IF M$ = "END" THEN GOTO 200
05050   M = VAL(M$)
05060   IF M < 1 OR M>LOF(1) + 1 THEN GOTO 5010
05070   CLS
05080   IF M < = LOF(1) THEN GET 2,M: PRINT "REMINDER EXISTS":FR = 1 : ELSE PRINT "NEW REMINDER":FR = 0
05090   Q$ = "MESSAGE NUMBER": GOSUB 10000: IF CM = 1 THEN GOTO 5130
05100   INPUT "ASSOCIATED MESSAGE NUMBER";AS
05110   IF AS < 1 OR AS>LOF(2) THEN 5100
05120   LSET MN$ = CHR$(AS)
05130   Q$ = "MINUTES INPUT": GOSUB 10000: IF CM = 1 THEN GOTO 5260
05140   PRINT "MINUTES INPUT FOR REMINDER";M
05150   A$ = STRING$(8,0)
05160   N$ = ""
05170   INPUT "MIN: NUMBER,RANGE OR 'NEXT'";N$
05180   IF N$ = "NEXT" THEN GOTO 5260
05190   N1 = VAL(N$):N2 = N1
05200   N3 = INSTR(N$,"-")
05210   N4 = LEN(N$)
05220   IF N3 <> 0 THEN N2 = VAL(RIGHT$(N$,N4 - N3))
05230   FOR T = N1 TO N2: GOSUB 1000: NEXT T
05240   LSET MI$ = A$
05250   GOTO 5160
05260   Q$ = "HOURS INPUT": GOSUB 10000: IF CM = 1 THEN GOTO 5390
05270   PRINT "HOURS INPUT"
05280   A$ = STRING$(3,0)
05290   N$ = ""
05300   INPUT "HRS: NUMBER,RANGE OR 'NEXT'";N$
05310   IF N$ = "NEXT" THEN GOTO 5390
05320   N1 = VAL(N$):N2 = N1
05330   N3 = INSTR(N$,"-")
05340   N4 = LEN(N$)
05350   IF N3 <> 0 THEN N2 = VAL(RIGHT$(N$,N4 - N3))
05360   FOR T = N1 TO N2: GOSUB 1000: NEXT T
05370   LSET HR$ = A$
05380   GOTO 5290
05390   Q$ = "DAYS INPUT": GOSUB 10000: IF CM = 1 THEN GOTO 5510
05400   PRINT "DAYS INPUT"
05410   A$ = CHR$(0)
05420   N$ = ""
05430   INPUT "DAY: NAME,'NEXT' OR 'ALL'";N$
05440   IF N$ = "NEXT" THEN GOTO 5500
05450   IF N$ = "ALL" THEN A$ = CHR$(255): GOTO 5500
05460   FOR T = 1 TO 7
05470   IF N$ = DN$(T) THEN GOSUB 1000
05480   NEXT T
05490   GOTO 5420
05500   LSET DA$ = A$
05510   Q$ = "DATE INPUT": GOSUB 10000: IF CM = 1 THEN GOTO 5570
05520   PRINT "DATE INPUT"
05530   GOSUB 9000: LSET D1$ = A$
05540   GOSUB 9000: LSET D2$ = A$
05550   GOSUB 9000: LSET D3$ = A$
05560   GOSUB 9000: LSET D4$ = A$
05570   PUT 1,M
05580   GOTO 5010
06000   : REM ' TEST BIT B OF A$
06010   B1 = INT(B / 8)
06020   B3 = 2 ^(B - B1 * 8)
06030   B4 = ASC(MID$(A$,B1 + 1,1))
06040   FL = SGN(B4 AND B3)
06050   RETURN
07000   : REM ' PRINT DATES
07010   Y1 = ASC(LEFT$(A$,1))
07020   Y2 = ASC(MID$(A$,4,1))
07030   D1 = CVI(MID$(A$,2,2))
07040   D2 = CVI(MID$(A$,5,2))
07050   IF Y1 = 0 OR Y2 = 0 THEN RETURN
07060   IF Y1> 98 OR Y2> 98 THEN RETURN
07070   H = Y1:N = 2: GOSUB 8000
07080   X$ = "-" + H$
07090   H = D1:N = 3: GOSUB 8000
07100   X$ = X$ + "/" + H$
07110   CMD "J",X$,X2$
07120   PRINT X2$;" TO ";
07130   H = Y2:N = 2: GOSUB 8000
07140   X$ = "-" + H$
07150   H = D2:N = 3: GOSUB 8000
07160   X$ = X$ + "/" + H$
07170   CMD "J",X$,X2$
07180   PRINT X2$
07190   RETURN
08000   : REM ' CONVERT A NUMBER INTO XXXX FORMAT
08010   H$ = "":N = N - 1
08020   H2 = INT(10 ^ N)
08030   H1 = INT(H / H2)
08040   H$ = H$ + CHR$(H1 + 48)
08050   H = INT(H - INT(H1 * H2))
08060   N = N - 1
08070   IF N < 0 THEN RETURN
08080   GOTO 8020
09000   : REM ' INPUT DATE RANGE
09010   M$ = ""
09020   INPUT "DATE,RANGE,'ALL' OR 'NONE'";M$
09030   IF M$ = "ALL" THEN M1$ = "01/01/00":M2$ = "01/01/00": GOTO 9080
09040   IF M$ = "NONE" THEN M1$ = "12/31/99":M2$ = "12/31/99": GOTO 9080
09050   IF LEN(M$)> 17 THEN GOTO 9020
09060   M1$ = LEFT$(M$,8):M2$ = M1$
09070   IF LEN(M$) = 17 THEN M2$ = RIGHT$(M$,8)
09080   Y = VAL(MID$(M1$,7,2)):A$ = CHR$(Y)
09090   CMD "J",M1$,X$:X = VAL(X$)
09100   A$ = A$ + MKI$(X)
09110   Y = VAL(MID$(M2$,7,2)):A$ = A$ + CHR$(Y)
09120   CMD "J",M2$,X$:X = VAL(X$)
09130   A$ = A$ + MKI$(X)
09140   I = 1
09150   A$ = A$ + CHR$(I)
09160   RETURN
10000   : REM ' TEST FOR MODIFYING EXISTING RECORD
10010   IF FR = 0 THEN CM = 0: RETURN
10020   PRINT "CHANGE ";Q$;"? (Y/N) ";
10030   I$ = INKEY$ : IF I$ = "" THEN 10030
10040   IF I$ = "Y" THEN CM = 0: PRINT "YES": RETURN
10050   IF I$ <> "N" THEN GOTO 10030
10060   CM = 1: PRINT "NO": RETURN
