00100   : REM ' MORSE RECEIVER VERSION 1.5
00110   ON ERROR GOTO 650
00120   CLS : OUT 254,0
00130   DEFINT A - Z
00140   GOTO 180
00150   REM      INSTRUCTIONS:
00160   INPUT "CHARACTER TIMING";CC
00170   INPUT "SPACE TIMING";SS: GOTO 240
00180   PRINT "RECEIVE MODE": RESTORE
00190   CLEAR 5000: DIM A$(100): FOR T = 1 TO 100: READ A$(T): NEXT T
00200   CC = 10:SS = 10
00210   INPUT "CHARACTER,SPACE TIMING";CC,SS
00220   TR = PEEK(32766) + 256 * PEEK(32767): INPUT "REQUEST DATA STORED IN MEMORY";A$: IF A$ = "Y" THEN G = - 1 : ELSE G = 0
00230   OUT 255,4: OUT 255,4
00240   A = INP(255) OR 64
00250   AB$ = INKEY$ : IF AB$ = "P" THEN 160 : ELSE IF AB$ = " " THEN GOTO 620
00260   IF A = 127 THEN 240
00270   B = 0
00280   IF A = 255 THEN OUT 255,4
00290   A = INP(255) OR 64:B = B + 10
00300   IF A = 127 THEN C =((5 * C) +(2 * B)) / 6:DO = 2 * DO:DA = 2 * DA:DO = DO + 1: GOTO 370
00310   IF B < (.5 * C) THEN 280
00320   DO = 2 * DO:DA = 2 * DA:DA = DA + 1
00330   IF A = 255 THEN OUT (255),4
00340   A = INP(255) OR 64:B = B + 10
00350   IF A = 255 THEN GOTO 330
00360   C =((4 * C) + B) / 5
00370   B = 0
00380   IF A = 255 THEN OUT (255),4
00390   A = INP(255) OR 64:B = B + CC
00400   IF A = 255 THEN GOTO 270
00410   IF B < .5 * C THEN GOTO 380
00420   GOSUB 480
00430   A = INP(255) OR 64:B = B + SS
00440   IF A = 255 THEN GOTO 270
00450   IF B < 2 * C THEN GOTO 430
00460   PRINT " ";
00470   GOTO 240
00480   DA = DA * 2
00490   D = DA + DO
00500   IF D> 100 THEN D = 100
00510   PRINT A$(D);
00520   DA = 0:DO = 0
00530   IF G = 0 THEN RETURN
00540   POKE TR - 65536, ASC(A$(D)):TR = TR + 1
00550   POKE 32767,TR / 256: POKE 32766,TR - PEEK(32767) * 256
00560   RETURN
00570   DATA E,T,I,A,N,M,S,U,R,W,D,K,G,O,H,V,F,-,L,-,P,J,B,X,C
00580   DATA Y,Z,Q,-,-,5,4,-,3,-,-,-,2,-,-,-,-,-,-,-,1,6,-,/,-
00590   DATA -,-,-,-,7,-,-,-,8,-,9,0,-,-,-,-,-,-,-,-,-,-,-,-,?
00600   DATA -,-,-,-,-,-,-,-,.,-,-,-,-,-,-,-,-,-,-,-,-,-,-,-,-
00610   END
00620   CLS : PRINT "DOT DISPLAY MODE"
00630   OUT 255,4: IF(INP(255) OR 64) = 255 THEN PRINT "-";: ELSE PRINT " ";
00640   IF INKEY$ = CHR$(13) THEN OUT 255,4: CLS : PRINT "RECEIVE MODE": GOTO 230 : ELSE GOTO 630
00650   RUN
