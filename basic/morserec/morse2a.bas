00005   : REM ' MORSE RECEIVER VERSION 1.5
00007   ON ERROR GOTO 10000
00010   CLS : OUT 254,0
00015   DEFINT A - Z
00020   GOTO 1230
00022   REM      INSTRUCTIONS:
01210   INPUT "CHARACTER TIMING";CC
01220   INPUT "SPACE TIMING";SS: GOTO 1250
01230   PRINT "RECEIVE MODE": RESTORE
01240   CLEAR 5000: DIM A$(100): FOR T = 1 TO 100: READ A$(T): NEXT T
01241   CC = 10:SS = 10
01242   INPUT "CHARACTER,SPACE TIMING";CC,SS
01243   TR = PEEK(32766) + 256 * PEEK(32767): INPUT "REQUEST DATA STORED IN MEMORY";A$: IF A$ = "Y" THEN G = - 1 : ELSE G = 0
01245   OUT 255,4: OUT 255,4
01250   A = INP(255)
01260   AB$ = INKEY$ : IF AB$ = "P" THEN 1210 : ELSE IF AB$ = " " THEN GOTO 4999
01290   IF A = 127 THEN 1250
01300   B = 0
01310   IF A = 255 THEN OUT 255,4
01320   A = INP(255):B = B + 10
01330   IF A = 127 THEN C =((5 * C) +(2 * B)) / 6:DO = 2 * DO:DA = 2 * DA:DO = DO + 1: GOTO 1400
01340   IF B < (.5 * C) THEN 1310
01350   DO = 2 * DO:DA = 2 * DA:DA = DA + 1
01360   IF A = 255 THEN OUT (255),4
01370   A = INP(255):B = B + 10
01380   IF A = 255 THEN GOTO 1360
01390   C =((4 * C) + B) / 5
01400   B = 0
01410   IF A = 255 THEN OUT (255),4
01420   A = INP(255):B = B + CC
01430   IF A = 255 THEN GOTO 1300
01440   IF B < .5 * C THEN GOTO 1410
01450   GOSUB 1510
01460   A = INP(255):B = B + SS
01470   IF A = 255 THEN GOTO 1300
01480   IF B < 2 * C THEN GOTO 1460
01490   PRINT " ";
01500   GOTO 1250
01510   DA = DA * 2
01520   D = DA + DO
01530   IF D> 100 THEN D = 100
01540   PRINT A$(D);
01550   DA = 0:DO = 0
01552   IF G = 0 THEN RETURN
01555   POKE TR - 65536, ASC(A$(D)):TR = TR + 1
01557   POKE 32767,TR / 256: POKE 32766,TR - PEEK(32767) * 256
01560   RETURN
01570   DATA E,T,I,A,N,M,S,U,R,W,D,K,G,O,H,V,F,-,L,-,P,J,B,X,C
01580   DATA Y,Z,Q,-,-,5,4,-,3,-,-,-,2,-,-,-,-,-,-,-,1,6,-,/,-
01590   DATA -,-,-,-,7,-,-,-,8,-,9,0,-,-,-,-,-,-,-,-,-,-,-,-,?
01600   DATA -,-,-,-,-,-,-,-,.,-,-,-,-,-,-,-,-,-,-,-,-,-,-,-,-
01610   END
04999   CLS : PRINT "DOT DISPLAY MODE"
05000   OUT 255,4: IF INP(255) = 255 THEN PRINT "-";: ELSE PRINT " ";
05005   IF INKEY$ = CHR$(13) THEN OUT 255,4: CLS : PRINT "RECEIVE MODE": GOTO 1245 : ELSE GOTO 5000
10000   RUN
